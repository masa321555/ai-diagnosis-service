# Google認証・会員制機能 動作確認チェックリスト

## 環境情報
- **確認日**: 2026/02/11
- **確認者**: Claude Code（curl による自動確認）
- **環境**: localhost:3000
- **確認方法**: curl + SSR HTML解析（ブラウザ操作不可のため一部項目は未確認）

---

## 1. ログインページの表示（/auth/signin）

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 1-1 | `/auth/signin` にアクセスするとログインページが表示される | [x] | HTTP 200、SSR HTML確認済み |
| 1-2 | グラデーション背景が表示される | [x] | CSS `linear-gradient(135deg, #667eea 0%, #764ba2 100%)` 確認済み |
| 1-3 | 「AIキャリア診断」のタイトルが表示される | [x] | `<h4>AIキャリア診断</h4>` SSR出力確認済み |
| 1-4 | 「Googleでログイン」ボタンが表示される | [x] | `<button>...Googleでログイン</button>` + GoogleIcon SVG 確認済み |
| 1-5 | 利用規約・プライバシーポリシーのリンクが表示される | [x] | `<a href="/terms">利用規約</a>` `<a href="/privacy">プライバシーポリシー</a>` 確認済み |
| 1-6 | 利用規約リンクをクリックすると `/terms` に遷移する | [-] | ブラウザ操作不可のため要手動確認（href="/terms" は正しい） |
| 1-7 | プライバシーポリシーリンクをクリックすると `/privacy` に遷移する | [-] | ブラウザ操作不可のため要手動確認（href="/privacy" は正しい） |

## 2. Googleログインボタンの動作

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 2-1 | 「Googleでログイン」ボタンをクリックするとGoogle認証画面に遷移する | [-] | ブラウザ操作不可。providers API で Google 設定確認済み（signinUrl, callbackUrl 正常） |
| 2-2 | Googleアカウント選択画面が表示される | [-] | 要手動確認（Google Cloud Console 側の設定に依存） |
| 2-3 | アプリ名・要求する権限が正しく表示される | [-] | 要手動確認（Google Cloud Console 側の設定に依存） |

## 3. ログイン成功後のリダイレクト

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 3-1 | Google認証完了後、`/dashboard` にリダイレクトされる | [-] | 要手動確認（signIn の callbackUrl: '/dashboard' はコード上設定済み） |
| 3-2 | エラーなくページが表示される | [-] | 要手動確認 |
| 3-3 | MongoDBにユーザー情報が保存される（初回ログイン時） | [-] | 要手動確認（Atlas で users コレクション確認） |

## 4. ダッシュボードの表示（/dashboard）

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 4-1 | 「ダッシュボード」タイトルが表示される | [-] | 要ログイン後に手動確認（コード上は正しい） |
| 4-2 | ユーザーのアバター画像が表示される | [-] | 要手動確認 |
| 4-3 | ユーザーの名前が表示される | [-] | 要手動確認 |
| 4-4 | ユーザーのメールアドレスが表示される | [-] | 要手動確認 |
| 4-5 | 「プロフィール設定」リンクが表示される | [-] | 要手動確認（コード上 href="/profile" 設定済み） |
| 4-6 | 「プロフィール設定」をクリックすると `/profile` に遷移する | [-] | 要手動確認 |
| 4-7 | 「ログアウト」ボタンが表示される | [-] | 要手動確認（コード上 signOut 設定済み） |

## 5. プロフィールページの表示（/profile）

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 5-1 | 「プロフィール」タイトルが表示される | [-] | 要ログイン後に手動確認 |
| 5-2 | 「ダッシュボードに戻る」リンクが表示される | [-] | 要手動確認 |
| 5-3 | ユーザーのアバター画像が大きく表示される | [-] | 要手動確認 |
| 5-4 | メールアドレスが表示される（編集不可） | [-] | 要手動確認 |
| 5-5 | 名前の入力欄に現在の名前が表示される | [-] | 要手動確認 |
| 5-6 | 「保存」ボタンが表示される | [-] | 要手動確認 |

## 6. プロフィール編集の動作

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 6-1 | 名前を変更して「保存」をクリックできる | [-] | 要手動確認 |
| 6-2 | 保存成功時に「プロフィールを更新しました」トーストが表示される | [-] | 要手動確認 |
| 6-3 | 保存後、MongoDBのユーザー情報が更新されている | [-] | 要手動確認（Atlas で確認） |
| 6-4 | 名前を空にすると「保存」ボタンが無効化される | [-] | 要手動確認（コード上 disabled={!name.trim()} 設定済み） |
| 6-5 | ページをリロードしても変更後の名前が維持される | [-] | 要手動確認 |

## 7. ログアウト機能

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 7-1 | ダッシュボードの「ログアウト」ボタンをクリックできる | [-] | 要手動確認 |
| 7-2 | ログアウト後、トップページ（`/`）にリダイレクトされる | [-] | 要手動確認（コード上 callbackUrl: '/' 設定済み） |
| 7-3 | ログアウト後、`/dashboard` にアクセスすると `/auth/signin` にリダイレクトされる | [-] | 要手動確認 |

## 8. 未ログイン時のリダイレクト（保護ルート）

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 8-1 | 未ログイン状態で `/dashboard` にアクセスすると `/auth/signin` にリダイレクトされる | [x] | HTTP 307 → `/auth/signin?callbackUrl=...dashboard` 確認済み |
| 8-2 | 未ログイン状態で `/profile` にアクセスすると `/auth/signin` にリダイレクトされる | [x] | HTTP 307 → `/auth/signin?callbackUrl=...profile` 確認済み |
| 8-3 | 未ログイン状態で `/` にはアクセスできる | [x] | HTTP 200 確認済み |
| 8-4 | 未ログイン状態で `/auth/signin` にはアクセスできる | [x] | HTTP 200 確認済み |

## 9. セッションの維持

| # | 確認項目 | 結果 | 備考 |
|---|---------|------|------|
| 9-1 | ログイン後、ページをリロードしてもログイン状態が維持される | [-] | 要手動確認（JWT セッション設定済み） |
| 9-2 | ログイン後、別タブで `/dashboard` を開いてもログイン状態が維持される | [-] | 要手動確認 |
| 9-3 | ブラウザを閉じて再度開いてもログイン状態が維持される | [-] | 要手動確認 |

---

## 確認結果サマリー

| カテゴリ | 合計 | 確認済み [x] | 要手動確認 [-] |
|---------|------|-------------|---------------|
| 1. ログインページ表示 | 7 | 5 | 2 |
| 2. Googleログインボタン | 3 | 0 | 3 |
| 3. ログイン成功後リダイレクト | 3 | 0 | 3 |
| 4. ダッシュボード表示 | 7 | 0 | 7 |
| 5. プロフィールページ表示 | 6 | 0 | 6 |
| 6. プロフィール編集 | 5 | 0 | 5 |
| 7. ログアウト機能 | 3 | 0 | 3 |
| 8. 未ログイン時リダイレクト | 4 | 4 | 0 |
| 9. セッション維持 | 3 | 0 | 3 |
| **合計** | **41** | **9** | **32** |

## 判定基準
- `[x]` = 確認済み（合格）
- `[-]` = ブラウザ操作が必要なため要手動確認
- `[ ]` = 不合格

## 補足
- Auth.js providers API (`/api/auth/providers`) で Google プロバイダーの登録を確認済み
- Google OAuth の signinUrl: `/api/auth/signin/google`、callbackUrl: `/api/auth/callback/google` が正しく設定されている
- ログイン後の動作確認（セクション2〜7, 9）は、ブラウザでの手動確認が必要です
